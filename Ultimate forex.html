<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ماشین حساب نهایی مدیریت ریسک فارکس</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
  <div id="root" class="min-h-screen flex items-center justify-center p-4"></div>
  <script type="text/babel">
    const { useState } = React;const symbols = {
  "XAUUSD": 100,
  "EURUSD": 100000,
  "GBPUSD": 100000,
  "USDJPY": 100000,
  "BTCUSD": 1
};

function TradeCalculator() {
  const [trades, setTrades] = useState([]);
  const [form, setForm] = useState({symbol: "XAUUSD", balance: "", risk: "", entry: "", stop: "", target: ""});

  const calculate = () => {
    const riskAmount = (parseFloat(form.balance) * parseFloat(form.risk)) / 100;
    const diff = Math.abs(parseFloat(form.entry) - parseFloat(form.stop));
    const lotSize = symbols[form.symbol] || 100000;
    const lot = (riskAmount / diff) / lotSize;
    const reward = Math.abs(parseFloat(form.entry) - parseFloat(form.target)) * lot * lotSize;
    const rr = reward / riskAmount;
    setTrades([...trades, { ...form, lot: lot.toFixed(2), riskAmount: riskAmount.toFixed(2), rr: rr.toFixed(2) }]);
  };

  const clearAll = () => setTrades([]);
  const deleteTrade = (index) => setTrades(trades.filter((_, i) => i !== index));

  return (
    <div className="w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 space-y-4">
      <h1 className="text-2xl font-bold text-center">ماشین حساب نهایی مدیریت ریسک و حجم معامله</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-semibold mb-1">نماد</label>
          <select
            className="w-full p-2 border rounded-xl dark:bg-gray-700"
            value={form.symbol}
            onChange={(e) => setForm({ ...form, symbol: e.target.value })}
          >
            {Object.keys(symbols).map((s) => (
              <option key={s} value={s}>{s}</option>
            ))}
          </select>
        </div>
        {Object.entries({balance: "موجودی", risk: "درصد ریسک", entry: "ورودی", stop: "استاپ لاس", target: "تارگت"}).map(([key, label]) => (
          <div key={key}>
            <label className="block text-sm font-semibold mb-1">{label}</label>
            <input
              className="w-full p-2 border rounded-xl dark:bg-gray-700 focus:outline-none focus:ring focus:ring-blue-400"
              placeholder={label}
              value={form[key]}
              onChange={(e) => setForm({ ...form, [key]: e.target.value })}
              type="number"
            />
          </div>
        ))}
      </div>
      <button onClick={calculate} className="w-full bg-blue-500 text-white py-2 rounded-xl hover:bg-blue-600">محاسبه</button>
      <button onClick={clearAll} className="w-full bg-red-500 text-white py-2 rounded-xl hover:bg-red-600">حذف همه</button>
      <div className="overflow-x-auto">
        <table className="w-full text-sm text-left mt-4 border">
          <thead>
            <tr className="bg-blue-500 text-white">
              <th className="p-2">نماد</th>
              <th className="p-2">ورودی</th>
              <th className="p-2">استاپ</th>
              <th className="p-2">لات</th>
              <th className="p-2">ریسک ($)</th>
              <th className="p-2">R:R</th>
              <th className="p-2">حذف</th>
            </tr>
          </thead>
          <tbody>
            {trades.map((t, i) => (
              <tr key={i} className="odd:bg-white even:bg-gray-50 dark:odd:bg-gray-700 dark:even:bg-gray-600">
                <td className="p-2">{t.symbol}</td>
                <td className="p-2">{t.entry}</td>
                <td className="p-2">{t.stop}</td>
                <td className="p-2">{t.lot}</td>
                <td className="p-2">{t.riskAmount}</td>
                <td className={`p-2 ${parseFloat(t.rr) >= 2 ? "text-green-600 font-bold" : parseFloat(t.rr) < 1 ? "text-red-600 font-bold" : ""}`}>{t.rr}</td>
                <td className="p-2"><button className="bg-red-400 text-white px-2 rounded" onClick={() => deleteTrade(i)}>X</button></td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

ReactDOM.render(<TradeCalculator />, document.getElementById("root"));

  </script>
</body>
</html>
